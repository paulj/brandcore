<div id="brand_personality_field">
  <%= form_with model: brand_vision, url: brand_vision_path(brand), method: :patch, data: { turbo: true, controller: "autosave", autosave_target: "form" } do |f| %>
    <div class="space-y-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Traits</label>
        <p class="text-sm text-gray-500 mb-3">Enter personality traits (e.g., innovative, approachable, professional)</p>
        <div class="space-y-2" data-controller="tag-input" data-tag-input-field-name-value="brand_vision[traits][]">
          <input type="text"
                 data-tag-input-target="input"
                 data-action="keydown.enter->tag-input#addTag:prevent"
                 class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent"
                 placeholder="Type a trait and press Enter...">
          <div id="traits-container" class="flex flex-wrap gap-2" data-tag-input-target="container">
            <% traits = brand_vision.traits || [] %>
            <% traits.each do |trait| %>
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-800">
                <%= trait %>
                <button type="button" class="ml-2 text-gray-500 hover:text-gray-700" data-action="click->tag-input#removeTag">×</button>
              </span>
            <% end %>
          </div>
          <% traits.each_with_index do |trait, index| %>
            <%= f.hidden_field "traits[]", value: trait, data: { tag_input_target: "hiddenField" } %>
          <% end %>
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Tone</label>
        <p class="text-sm text-gray-500 mb-3">Enter tone descriptors (e.g., confident, friendly, authoritative)</p>
        <div class="space-y-2" data-controller="tag-input" data-tag-input-field-name-value="brand_vision[tone][]">
          <input type="text"
                 data-tag-input-target="input"
                 data-action="keydown.enter->tag-input#addTag:prevent"
                 class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent"
                 placeholder="Type a tone and press Enter...">
          <div id="tone-container" class="flex flex-wrap gap-2" data-tag-input-target="container">
            <% tone = brand_vision.tone || [] %>
            <% tone.each do |tone_item| %>
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-800">
                <%= tone_item %>
                <button type="button" class="ml-2 text-gray-500 hover:text-gray-700" data-action="click->tag-input#removeTag">×</button>
              </span>
            <% end %>
          </div>
          <% tone.each_with_index do |tone_item, index| %>
            <%= f.hidden_field "tone[]", value: tone_item, data: { tag_input_target: "hiddenField" } %>
          <% end %>
        </div>
      </div>

      <!-- Suggestions container (replaced via Turbo Streams) -->
      <div id="brand_personality_suggestions"></div>
    </div>
  <% end %>
</div>
